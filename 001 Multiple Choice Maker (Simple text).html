
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chris' Multiple Choice Generator</title>
<style>
    /* TEACHER UI - 006 AESTHETIC */
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; margin: 0; padding: 20px; color: #1a1a1a; }
    .teacher { max-width: 1400px; margin: auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 8px 30px rgba(0,0,0,0.08); }
    h1 { text-align: center; color: #003366; margin-bottom: 30px; font-weight: 700; font-size: 32px; letter-spacing: -0.5px; }
    
    .settings-panel { display: flex; gap: 20px; align-items: center; background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px; border: 1px solid #e0e4e8; }
    .settings-panel label { font-weight: 600; font-size: 16px; color: #444; }
    .settings-panel input { padding: 12px; border: 1px solid #ced4da; border-radius: 6px; font-size: 16px; flex-grow: 1; }

    .row { display: grid; grid-template-columns: 40px 1.8fr 1.2fr repeat(4, 1fr) 140px 50px; gap: 12px; margin-bottom: 12px; align-items: center; padding: 15px; background: #fff; border: 1px solid #edf0f2; border-radius: 8px; }
    .choice-cell { display: flex; align-items: center; gap: 8px; background: #fdfdfd; padding: 6px; border-radius: 6px; border: 1px solid #eef0f2; }
    .row input[type="text"] { width: 100%; box-sizing: border-box; padding: 10px; border: 1px solid #dcdfe3; border-radius: 5px; font-size: 14px; }
    .row input[type="radio"] { width: 20px; height: 20px; cursor: pointer; accent-color: #003366; }
    
    .deleteBtn { background: #dc3545; color: white; border: none; width: 40px; height: 40px; cursor: pointer; border-radius: 8px; font-weight: bold; font-size: 18px; display: flex; align-items: center; justify-content: center; }
    .img-preview { max-height: 50px; border-radius: 6px; display: none; border: 1px solid #ddd; }
    .controls { display: flex; gap: 20px; margin-top: 40px; justify-content: center; }
    button.main-btn { font-size: 16px; padding: 14px 30px; cursor: pointer; border-radius: 10px; border: none; background: #003366; color: white; font-weight: 600; box-shadow: 0 4px 6px rgba(0,51,102,0.15); }
    button.secondary { background: #6c757d; }

    /* STUDENT UI - PERSISTENT ENGINE */
    #studentApp { display: none; }
    body.student-mode { text-align: center; background: #f4f7fa; margin: 0; padding: 0; overflow-x: hidden; }
    
    body.scale-1 #gameContent { font-size: 28px; } 
    body.scale-2 #gameContent { font-size: 34px; } 
    body.scale-3 #gameContent { font-size: 40px; } 
    body.scale-4 #gameContent { font-size: 46px; } 
    body.scale-5 #gameContent { font-size: 22px; }
    
    .screen { display: none; padding: 20px; min-height: 100vh; box-sizing: border-box; }
    .screen.active { display: flex; flex-direction: column; align-items: center; justify-content: center; }
    
    #introScreen { background: #003366; color: white; }
    .btn-start { font-size: 24px; padding: 15px 50px; cursor: pointer; background: white; color: #003366; border: none; border-radius: 50px; font-weight: bold; }
    
    #gameScreen { padding-bottom: 100px; justify-content: flex-start; }
    
    /* SLIM NAVIGATION (Doesn't resize) */
    #bottomBar { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #ccc; padding: 10px; display: none; justify-content: center; gap: 15px; z-index: 100; font-size: 16px !important; }
    .nav-btn { font-size: 16px !important; padding: 8px 20px; cursor: pointer; border: 1px solid #adb5bd; border-radius: 8px; background: #fff; font-weight: bold; color: #333; }
    
    #zoomBtn { position: fixed; right: 25px; bottom: 85px; width: 50px; height: 50px; border-radius: 50%; border: none; background: #003366; color: white; font-size: 22px !important; cursor: pointer; z-index: 101; display: none; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

    #gameContent { width: 100%; max-width: 1100px; margin: 0 auto; transition: font-size 0.2s; }
    .img-container { width: 100%; display: flex; justify-content: center; margin: 15px 0; }
    #qImg { max-width: 80%; max-height: 220px; border-radius: 12px; display: none; }
    #questionText { font-weight: 700; margin: 20px 0; padding: 0 15px; line-height: 1.2; }

    .choices-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px; width: 95%; margin: 15px auto; }
    .choice-btn { font-size: 0.8em; padding: 18px 12px; background: white; border: 3px solid #003366; border-radius: 15px; cursor: pointer; font-weight: 700; color: #003366; }
    
    .choice-btn.correct { background: #28a745 !important; color: white; border-color: #28a745; cursor: default; }
    .choice-btn.wrong { background: #dc3545 !important; color: white; border-color: #dc3545; cursor: default; opacity: 0.7; pointer-events: none; }
    
    #feedback { font-size: 1em; font-weight: bold; margin: 15px; min-height: 1.5em; }
    #watermark { position: fixed; left: 15px; bottom: 70px; font-size: 12px !important; opacity: 0.4; cursor: pointer; z-index: 1000; color: #003366; font-weight: bold; }
</style>
</head>
<body class="scale-1">

<div id="teacherApp" class="teacher">
    <h1>Chris' Multiple Choice Generator</h1>
    <div class="settings-panel">
        <label>Game Title:</label>
        <input type="text" id="titleInput" placeholder="Enter quiz title..." value="">
        <label>Editor Password:</label>
        <input type="password" id="pwInput" placeholder="Password" style="max-width:160px;" value="admin">
    </div>
    <div id="rowsContainer"></div>
    <div class="controls">
        <button class="main-btn secondary" onclick="goBack()">‚¨Ö Back to Main Page</button>
        <button class="main-btn secondary" onclick="clearAll()">üóë Clear All</button>
        <button class="main-btn" onclick="generate()">üíæ Generate Student Game</button>
    </div>
</div>

<div id="studentApp">
    <div id="introScreen" class="screen active">
        <h1 id="mainTitle">Quiz Game</h1>
        <button class="btn-start" onclick="startGame()">START QUIZ</button>
    </div>
    <div id="gameScreen" class="screen">
        <div id="gameContent">
            <div id="questionText"></div>
            <div class="hint-box" id="hintBox">
                <button id="hintBtn" style="font-size:0.5em; padding:6px 12px; border-radius:20px; border:1px solid #003366; cursor:pointer;" onclick="toggleHint()">Show Hint</button>
                <div id="hintText" style="font-style:italic; color:#666; margin-top:8px; font-size:0.7em; display:none;"></div>
            </div>
            <div class="img-container"><img id="qImg"></div>
            <div id="choices" class="choices-grid"></div>
            <div id="feedback"></div>
        </div>
    </div>
    <div id="bottomBar">
        <button class="nav-btn" onclick="prev()">‚¨Ö Back</button>
        <button class="nav-btn" onclick="next()">Next ‚û°</button>
    </div>
    <button id="zoomBtn" onclick="toggleZoom()">üîç</button>
    <div id="watermark" onclick="rehydrate()">cmarasigan</div>
</div>

<script>
let startData = []; 
let activePW = "admin";

const container = document.getElementById('rowsContainer');
const titleInput = document.getElementById('titleInput');
const pwInput = document.getElementById('pwInput');

window.onload = () => {
    container.innerHTML = "";
    if(startData.length > 0) {
        document.getElementById("teacherApp").style.display = "none";
        document.getElementById("studentApp").style.display = "block";
        document.body.classList.add('student-mode');
        pwInput.value = activePW;
        startData.forEach(d => addRow(d));
    } else {
        addRow();
    }
};

function rehydrate() {
    if(prompt("Enter Teacher Password:") === pwInput.value) {
        document.getElementById("studentApp").style.display = "none";
        document.getElementById("teacherApp").style.display = "block";
        document.body.classList.remove('student-mode');
        document.body.style.overflow = "auto";
    }
}

function addRow(existingData = null) {
    const rowId = Math.random();
    const div = document.createElement('div');
    div.className = 'row';
    const getC = (i) => existingData ? (existingData.choices[i] || "") : "";
    const isCorr = (i) => existingData ? (existingData.correct === i) : (i === 0);

    div.innerHTML = `
        <div style="font-weight:700; color:#adb5bd; font-size:14px; text-align:center;">#</div>
        <input type="text" placeholder="Question" oninput="autoAdd(this)" value="${existingData ? existingData.q : ''}">
        <input type="text" placeholder="Hint" value="${existingData ? existingData.h : ''}">
        <div class="choice-cell"><input type="radio" name="r_${rowId}" ${isCorr(0)?'checked':''}> <input type="text" placeholder="Choice 1" value="${getC(0)}"></div>
        <div class="choice-cell"><input type="radio" name="r_${rowId}" ${isCorr(1)?'checked':''}> <input type="text" placeholder="Choice 2" value="${getC(1)}"></div>
        <div class="choice-cell"><input type="radio" name="r_${rowId}" ${isCorr(2)?'checked':''}> <input type="text" placeholder="Choice 3" value="${getC(2)}"></div>
        <div class="choice-cell"><input type="radio" name="r_${rowId}" ${isCorr(3)?'checked':''}> <input type="text" placeholder="Choice 4" value="${getC(3)}"></div>
        <div class="img-upload-cell">
            <input type="file" accept="image/*" style="display:none" id="file_${rowId}" onchange="previewImg(this)">
            <button class="main-btn secondary" style="font-size:11px; padding:6px 12px; border-radius:6px" onclick="document.getElementById('file_${rowId}').click()">üñºÔ∏è Image</button>
            <img class="img-preview" src="${existingData && existingData.img ? existingData.img : ''}" style="display:${existingData && existingData.img ? 'block' : 'none'}">
        </div>
        <button class="deleteBtn" onclick="this.parentElement.remove(); renumber();">‚úñ</button>
    `;
    container.appendChild(div);
    renumber();
}

function previewImg(input) {
    const reader = new FileReader();
    reader.onload = e => { 
        const preview = input.parentElement.querySelector('.img-preview');
        preview.src = e.target.result; 
        preview.style.display = 'block'; 
    };
    if(input.files[0]) reader.readAsDataURL(input.files[0]);
}

function autoAdd(input) {
    if (input.parentElement === container.lastElementChild && input.value.trim() !== "") addRow();
}

function renumber() {
    [...container.children].forEach((row, i) => row.firstElementChild.textContent = i + 1);
}

function clearAll() {
    if(confirm("Clear all questions?")) { container.innerHTML = ""; addRow(); }
}

function goBack() { window.location.href = 'index.html'; }

function generate() {
    const data = [];
    [...container.children].forEach(row => {
        const q = row.querySelector('input[placeholder="Question"]').value.trim();
        if(q) {
            const cells = row.querySelectorAll('.choice-cell');
            let choices = [], correct = 0;
            cells.forEach((cell, i) => {
                const val = cell.querySelector('input[type="text"]').value.trim();
                if(val) { choices.push(val); if(cell.querySelector('input[type="radio"]').checked) correct = choices.length - 1; }
            });
            data.push({ q, h: row.querySelectorAll('input')[1].value.trim(), img: row.querySelector('.img-preview').src.startsWith('data') ? row.querySelector('.img-preview').src : null, choices, correct });
        }
    });

    if(!data.length) return alert("Add questions!");
    let docStr = document.documentElement.outerHTML;
    docStr = docStr.replace(/let startData = \[.*?\];/, `let startData = ${JSON.stringify(data)};`);
    docStr = docStr.replace(/let activePW = ".*?";/, `let activePW = "${pwInput.value}";`);
    docStr = docStr.replace(/id="titleInput" value=".*?"/, `id="titleInput" value="${titleInput.value}"`);
    docStr = docStr.replace(/id="pwInput" value=".*?"/, `id="pwInput" value="${pwInput.value}"`);

    const blob = new Blob([docStr], {type: 'text/html'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = (titleInput.value || "Quiz").replace(/\s+/g, '_') + ".html";
    a.click();
}

/* STUDENT ENGINE - ELIMINATION LOGIC */
let index = 0, scale = 1, solved = false;

function toggleZoom() { 
    scale = (scale % 5) + 1; 
    document.body.className = 'student-mode scale-' + scale; 
}

function startGame() {
    document.getElementById('mainTitle').textContent = titleInput.value || "Quiz Game";
    document.getElementById('introScreen').classList.remove('active');
    document.getElementById('gameScreen').classList.add('active');
    document.getElementById('bottomBar').style.display = 'flex';
    document.getElementById('zoomBtn').style.display = 'flex';
    loadQuestion();
}

function toggleHint() {
    const t = document.getElementById('hintText');
    const isH = window.getComputedStyle(t).display === 'none';
    t.style.display = isH ? 'block' : 'none';
    document.getElementById('hintBtn').textContent = isH ? 'Hide Hint' : 'Show Hint';
}

function loadQuestion() {
    solved = false;
    const qD = startData[index];
    const corrStr = qD.choices[qD.correct];
    const shuffled = [...qD.choices].sort(() => Math.random() - 0.5);
    
    document.getElementById('questionText').textContent = qD.q;
    document.getElementById('feedback').textContent = "";
    document.getElementById('hintText').textContent = qD.h || "";
    document.getElementById('hintText').style.display = 'none';
    document.getElementById('hintBtn').textContent = 'Show Hint';
    document.getElementById('hintBox').style.display = qD.h ? 'block' : 'none';
    
    const img = document.getElementById('qImg');
    if(qD.img) { img.src = qD.img; img.style.display = 'block'; } else { img.style.display = 'none'; }
    
    const ctn = document.getElementById('choices');
    ctn.innerHTML = "";
    shuffled.forEach(t => {
        const b = document.createElement('button');
        b.className = 'choice-btn';
        b.textContent = t;
        b.onclick = () => {
            if(solved) return; // Question is already finished
            
            if(t === corrStr) {
                solved = true;
                b.classList.add('correct');
                document.getElementById('feedback').textContent = "‚úÖ Correct!";
                // Disable all others once correct
                [...document.querySelectorAll('.choice-btn')].forEach(btn => btn.style.pointerEvents = "none");
            } else {
                b.classList.add('wrong');
                document.getElementById('feedback').textContent = "‚ùå Incorrect";
            }
        };
        ctn.appendChild(b);
    });
}
function next() { if (index < startData.length - 1) { index++; loadQuestion(); } else { document.getElementById('feedback').textContent = "üéâ Quiz Complete!"; } }
function prev() { if (index > 0) { index--; loadQuestion(); } }
</script>
</body>
</html>